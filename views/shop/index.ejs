<%- include("../includes/start.ejs") %>
<body>
  <%- include("../includes/navigation.ejs") %>
  <main class="main">
    <% if (products.length > 0) { %>
    <section class="main__section">
      <div class="grid">
        <% {products.map(item => { %> <% const {name, image, price, _id} = item %>
        <div class="item__card">
          <div class="item__image">
            <img src="<%= image %>" alt="product image" />
          </div>
          <div class="item__info">
            <p>$<%= price %></p>
            <p><%= name %></p>
          </div>
          <div class="item__btnCon">
            <form
              action="/products/<%= _id %>"
              method="get"
              
            >
              <button class="item__btn">Details</button>
            </form>
            <% if(isAuthenticated){ %>
              <form
                action="/add-to-cart/<%= _id %>"
                method="get"
                
              >
                <input type="text" name="_csrf" value="<%= csrfToken %>" class="offPage">
                <button class="item__btn">Add to Cart</button>
              </form>
            <% } %>
          </div>
        </div>
        <% })} %>
      </div>
      <%- include("../includes/pagination.ejs") %>
    </section>
    <% } else { %>
    <p class="main__p">No Products added yet</p>
    <% } %>
  </main>
</body>
<%- include("../includes/end.ejs") %>
